import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.metrics import classification_report, confusion_matrix, ConfusionMatrixDisplay, precision_score, recall_score, accuracy_score
data = pd.read_csv(r"C:\Users\karti\Downloads\emails.csv")
data

data= data.drop('Email No.', axis=1)
data.shape
data.describe()
data.info()
data['Prediction'].value_counts()

X = data.drop('Prediction', axis 1) 
y = data['Prediction']

from sklearn.model selection import train test split
X train, X_test, y_train, y_test =train_test_split(X, y, test_size =0.20)

from sklearn.neighbors import KNeighborsClassifier  neigh=KNeighborsClassifier(n_neighbors = 2) 
neigh.fit(X_train, y_train)

KNeighborsClassifier(n_neighbors= 2 )

y_pred =neigh.predict(X_test)

neigh.score (X_train, y_train)
neigh.score (X_test, y_test)

print("Confusion Matrix: ")
cm confusion_matrix(y_test, y_pred) 

mat ConfusionMatrixDisplay(confusion_matrix = cm)
mat.plot()
plt.show()

accuracy = accuracy_score(y_test, y_pred)
print("Accuracy:", accuracy)

error_rate = 1 - accuracy
print("Error Rate:", error_rate)

precision = precision_score(y_test, y_pred)
print("Precision:", precision)

recall = recall_score(y_test, y_pred)
print("Recall:", recall)

# Import SVC
from sklearn.svm import SVC
from sklearn.metrics import accuracy_score, confusion_matrix, classification_report

# Step 1: Create SVM model
svm_model = SVC(gamma='auto')

# Step 2: Train (fit) the model
svm_model.fit(X_train, y_train)

# Step 3: Predict on test data
y_pred = svm_model.predict(X_test)

# Step 4: Evaluate performance
print("âœ… SVM Classification Results:")
print("\nClassification Report:\n", classification_report(y_test, y_pred))
